<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            gap: 15px; 
            padding: 20px; 
        }
        
        .control-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
            width: 100%; 
        }
        
        .btn-large { 
            width: 100%; 
            height: 100px; 
            font-size: 24px; 
            background: var(--blue); 
            color: white; 
            border: none; 
            border-radius: 15px; 
        }
        
        .btn-sub { 
            padding: 20px; 
            background: #333; 
            color: white; 
            border: 1px solid var(--blue); 
            border-radius: 10px; 
            font-size: 18px; 
        }
        
        /* New HUD Styles */
        #remote-hud {
            display: flex;
            justify-content: space-around; /* Spreads items evenly */
            align-items: center;
            width: 100%;                   /* Forces full width to match buttons */
            box-sizing: border-box;        /* Ensures padding doesn't break width */
            gap: 10px;
            font-family: monospace;
            font-size: 0.8rem;
            color: #aaa;
            background: rgba(255,255,255,0.05);
            padding: 15px;                 /* Increased padding slightly */
            border-radius: 15px;           /* Matched button border-radius */
            border: 1px solid #444;
        }
        #remote-hud span { color: var(--white); font-weight: bold; }
    </style>
</head>
<body>

    <div class="header-container">
        <span class="app_icon">ðŸ’¬</span><span class="app_title_remote">WebPrompter.app</span>
    </div>
    
    <h3 id="rm-status" style="color:var(--yellow); margin:0;">Connecting...</h3> 
    
    <div id="remote-hud">
        <span>SPEED: <span id="disp-speed">--</span></span>
        <span>TIME: <span id="disp-time">--:--</span></span>
    </div>

    <button id="playBtn" class="btn-large">START</button>
    
    <div class="control-grid">
        <button class="btn-sub" onclick="send('speed-up')">Speed +</button>
        <button class="btn-sub" onclick="send('speed-down')">Speed -</button>
        <button class="btn-sub" onclick="send('size-up')">Size +</button>
        <button class="btn-sub" onclick="send('size-down')">Size -</button>
        <button class="btn-sub" onclick="send('mirror')" style="border-color: var(--yellow)">Mirror</button>
        <button class="btn-sub" onclick="send('page-up')" style="border-color: var(--yellow)">Scroll â†‘</button>
    </div>

    <script>
        const targetId = new URLSearchParams(window.location.search).get('remote');
        const peer = new Peer();
        let conn;
        let active = false;

        peer.on('open', () => {
            conn = peer.connect(targetId);
            
            conn.on('open', () => {
                document.getElementById('rm-status').innerText = 'CONNECTED';
                document.getElementById('rm-status').style.color = '#2ecc71';
            });

            // Listen for HUD updates from Host
            conn.on('data', (data) => {
                if(data.action === 'hud-update') {
                    document.getElementById('disp-speed').innerText = data.speed;
                    document.getElementById('disp-time').innerText = data.time;
                }
            });
        });

        function send(action) { if(conn) conn.send({action}); }

        document.getElementById('playBtn').onclick = function() {
            active = !active;
            this.innerText = active ? 'STOP' : 'START';
            this.style.background = active ? 'var(--red)' : 'var(--blue)';
            conn.send({action: 'toggle', state: active});
        };
    </script>

    <footer class="bliz-footer">
        Made by Alex Blizky with <span class="heart">ðŸŽ„</span><br>
        <a href="https://ko-fi.com/blizky" target="_blank" rel="noopener noreferrer">Buy me a Ko-fi</a>
        <img src="/assets/ko-fi.svg" alt="Ko-fi" class="icon-kofi"> 
    </footer>

</body>
</html>
